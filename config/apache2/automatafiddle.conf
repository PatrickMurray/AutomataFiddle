<VirtualHost *:80>
	ServerName  www.automatafiddle.com
	ServerAlias automatafiddle.com

	ServerAdmin webmaster@localhost
	
	RewriteEngine On
	RewriteCond %{HTTPS} off
	RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
</VirtualHost>


<VirtualHost *:80>
	ServerName  www.api.automatafiddle.com
	ServerAlias api.automatafiddle.com

	ServerAdmin webmaster@localhost

	RewriteEngine On
	RewriteCond %{HTTPS} off
	RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
</VirtualHost>


<IfModule mod_ssl.c>
	<VirtualHost *:443>
		ServerName  www.automatafiddle.com
		ServerAlias automatafiddle.com
		
		ServerAdmin webmaster@localhost
		DocumentRoot /var/www/AutomataFiddle/src/www
		
		SSLCertificateFile /etc/letsencrypt/live/automatafiddle.com/fullchain.pem
		SSLCertificateKeyFile /ect/letsencrypt/live/automatafiddle.com/privkey.pem
		Include /etc/letsencrypt/options-ssl-apache.conf

		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined
	
		<Directory /var/www/AutomataFiddle/src>
			Options -Indexes +FollowSymLinks -Includes -ExecCGI
			AllowOverride All
			Require all granted
			Allow from all
		</Directory>
	
		<Directory /var/www/AutomataFiddle/src/www>
			RewriteEngine on
			RewriteCond %{REQUEST_FILENAME} !-f
			RewriteRule . index.html
			
			AddType text/css .css
			AddType text/javascript .js
		</Directory>
	</VirtualHost>
	

	<VirtualHost *:80>
		ServerName www.api.automatafiddle.com
		ServerAlias api.automatafiddle.com
	
		ServerAdmin webmaster@localhost
		DocumentRoot /var/www/AutomataFiddle/src/api
		
		SSLCertificateFile /etc/letsencrypt/live/automatafiddle.com/fullchain.pem
		SSLCertificateKeyFile /ect/letsencrypt/live/automatafiddle.com/privkey.pem
		Include /etc/letsencrypt/options-ssl-apache.conf

		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined
	
		<Directory /var/www/AutomataFiddle/src>
			Options -Indexes +FollowSymLinks -Includes -ExecCGI
			AllowOverride All
			Require all granted
			Allow from all
		</Directory>
	
		<Directory /var/www/AutomataFiddle/src/api>
			RewriteEngine on
			RewriteCond %{REWRITE_FILENAME} !-f
			RewriteRule . index.php
		</Directory>
	</VirtualHost>
</IfModule>
